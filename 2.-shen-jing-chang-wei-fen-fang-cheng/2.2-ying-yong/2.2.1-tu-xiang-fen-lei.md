# 2.2.1 图像分类

用CNN进行图像分类几乎是所有人对深度学习的第一次介绍。这也是一个开始讨论神经微分方程的自然场所。

**数据集**  假设我们观察到一些图像，用3维张量$$R^{3×32×32}$$表示，分别对应通道（红、绿、蓝）、高度（32像素）和宽度（32像素）。假设每幅图像在$$R^{10}$$中都有一个相应的类标签，对应于该图像是什么的一次性编码：可能是 飞机、汽车、鸟、猫、鹿、狗、青蛙、马、船或卡车。

**模型** 设$$f_θ：R×R^{3×32×32} → R^{3×32×32}$$是一个卷积神经网络，$$\ell_θ : R^{3×32×32} → R^{10}$$是仿射变换。

那么我们可以将一个图像分类模型定义为

$$
\begin{aligned}
&\phi: \mathbb{R}^{3 \times 32 \times 32} \rightarrow \mathbb{R}^{10} \\
&\phi: y_{0} \mapsto \operatorname{softmax}\left(\ell_{\theta}(y(T))\right)
\end{aligned}
$$

其中$$y:[0, T]\rightarrow\mathbb{R}^{3\times 32\times 32}$$ 是



$$
y(0)=y_{0}, \quad \frac{\mathrm{d} y}{\mathrm{~d} t}(t)=f_{\theta}(t, y(t))
$$

的解。

**损失函数**  通过使用这个输出和真实标签之间的适当损失函数（交叉熵），我们可以训练这个模型，使其输出是输入图像属于这些类别的概率。

明确地说：给定一个图像数据集$$a_i∈R^{3×32×32}$$，对应的标签$$b_i∈R^{10}$$ , 对于样本$$i = 1, ... . ，N$$，我们可以通过训练$$\theta$$最小化交叉熵

$$
-\frac{1}{N} \sum_{i=1}^{N} b_{i} \cdot \log \phi\left(a_{i}\right)
$$

其中，$$\cdot$$表示点积，对数是按元素取值的。

**这只是一个例子**  在实践中，对于像图像分类这样的应用，使用连续时间模型通常没有什么好处。传统的残差网络（即显式离散化的神经ODEs）只是更容易操作。

因此，这只是一个例子。我们实际上并不建议使用神经 ODEs来完成这个任务，对于这个任务来说，标准的神经网络可能更有优势。

**流形假设**  神经ODE与流形优雅互动假设（数据位于或接近嵌入高维特征空间的某个低维流形；附录[A.5](../../fu-lu-a/a.5.md)）。 ODE描述了一个数据流形演化的流。

